title: "Example 5: LLM Tool Calling (Berlin Weather)"

description: An example workflow that demonstrates how to use an LLM to call external tools and handle their responses.

transitions:
  - id: greeting
    from: start
    to: ready
    call:
      - tool: CreateDocument
        args:
          document: AiMessageDocument
          update:
            content:
              role: user
              parts:
                - type: text
                  text: How is the weather in Berlin?

  - id: llm_turn
    from: ready
    to: prompt_executed
    call:
      - tool: AiGenerateText
        args:
          llm:
            provider: openai
            model: gpt-4o
          messagesSearchTag: message
          tools:
            - GetWeather
        assign:
          llmResponse: ${ result.data }

      - tool: CreateDocument
        args:
          id: ${ llmResponse.id }
          document: AiMessageDocument
          update:
            content: ${ llmResponse }

  - id: delegate_tools
    from: prompt_executed
    to: tool_calls_processed
    call:
      - tool: DelegateToolCall
        args:
          message: ${ llmResponse }
        assign:
          toolCallResult: ${ result.data }

  - id: route_next
    from: tool_calls_processed
    to:
      - tool_response
      - end
    call:
      - tool: SwitchTarget
        args:
          target: "{{#if toolCallResult.parts.length }}tool_response{{else}}end{{/if}}"

  - id: add_tool_response_message
    from: tool_response
    to: ready
    call:
      - tool: CreateDocument
        args:
          id: ${ toolCallResult.id }
          document: AiMessageDocument
          update:
            content: ${ toolCallResult }

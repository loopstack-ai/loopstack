title: 'LLM Tool Calling Example (Berlin Weather)'

description: An example workflow that demonstrates how to use an LLM to call external tools and handle their responses.

transitions:
  - id: greeting
    from: start
    to: ready
    call:
      - tool: createDocument
        args:
          document: aiMessageDocument
          update:
            content:
              role: user
              parts:
                - type: text
                  text: How is the weather in Berlin?

  - id: llm_turn
    from: ready
    to: prompt_executed
    call:
      - id: llm_call
        tool: aiGenerateText
        args:
          llm:
            provider: openai
            model: gpt-4o
          messagesSearchTag: message
          tools:
            - getWeather

      - tool: createDocument
        args:
          id: ${ runtime.tools.llm_turn.llm_call.data.id }
          document: aiMessageDocument
          update:
            content: ${ runtime.tools.llm_turn.llm_call.data }

  - id: route_with_tool_calls
    from: prompt_executed
    to: ready
    if: '{{ isToolCall runtime.tools.llm_turn.llm_call.data }}'
    call:
      - id: delegate
        tool: delegateToolCall
        args:
          message: ${ runtime.tools.llm_turn.llm_call.data }

      - tool: createDocument
        args:
          id: ${ runtime.tools.route_with_tool_calls.delegate.data.id }
          document: aiMessageDocument
          update:
            content: ${ runtime.tools.route_with_tool_calls.delegate.data }

  - id: route_without_tool_calls
    from: prompt_executed
    to: end
